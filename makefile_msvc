#
# Qt4xHb - Bindings libraries for Harbour/xHarbour and Qt Framework 4
#
# Copyright (C) 2017 Marcos Antonio Gambeta <marcosgambeta AT outlook DOT com>
#

#
# Makefile para compilação com Harbour/xHarbour e Visual C++ 2010
#

# Atenção! A compilação do código-fonte do projeto Qt4xHb requer o SDK do Qt
# Framework, que está disponível no site oficial do projeto.

QT_BIN_DIR = $(QTDIR)/bin
QT_INC_DIR = $(QTDIR)/include
QT_LIB_DIR = $(QTDIR)/lib

# lista de módulos
include mak/modules1.mak

# checa presença dos módulos na instalação do Qt Framework
include mak/modules2.mak

HB_BIN_DIR = $(HBDIR)/bin
HB_INC_DIR = $(HBDIR)/include

QT4XHB_INC_DIR = include
QT4XHB_OBJ_DIR = obj/$(QTVERSION)/$(QTCOMP)/$(QT32OR64)/$(QTPLATFORM)/$(HBCOMP)/$(HBVER)
QT4XHB_LIB_DIR = lib/$(QTVERSION)/$(QTCOMP)/$(QT32OR64)/$(QTPLATFORM)/$(HBCOMP)/$(HBVER)
QT4XHB_SRC_DIR = source

OBJEXT = .obj
LIBEXT = .lib
LIBPRE =

HB = $(HB_BIN_DIR)/harbour

# PRGFLAGS
PRGFLAGS = -n -w3 -gc3
ifeq ($(HBCOMP),xharbour)
   PRGFLAGS = -n -w2
endif

CC = cl

CFLAGS = /c /nologo
CFLAGS += -DUNICODE
CFLAGS += -DQT_DLL
CFLAGS += -DQT_NO_DEBUG
CFLAGS += -DQT_THREAD_SUPPORT
include mak/modules3.mak

CINCLUDES =
CINCLUDES += -I$(QT_INC_DIR)
CINCLUDES += -I$(QT_INC_DIR)/Qt
include mak/modules4.mak
CINCLUDES += -I$(QT4XHB_INC_DIR)
CINCLUDES += -I$(QT4XHB_SRC_DIR)
CINCLUDES += -I$(HB_INC_DIR)

MOC = $(QT_BIN_DIR)/moc

# include mak/modules5.mak
# include mak/modules6.mak

include mak/modules7.mak

OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/events$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/signals$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/dummy$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/version$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/qt4xhb_utils$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/habstractlistmodel$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/habstractlistmodelMoc$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/habstractlistmodelbin$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/habstractlistmodelcls$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/habstracttablemodel$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/habstracttablemodelMoc$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/habstracttablemodelbin$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/habstracttablemodelcls$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/habstracttablemodelV2$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/habstracttablemodelV2Moc$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/habstracttablemodelclsV2$(OBJEXT)
OBJECTS_QTCORE += $(QT4XHB_OBJ_DIR)/qt4xhbbase$(OBJEXT)

ALLLIBS =
include mak/modules8.mak

all: $(ALLLIBS)

$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqaxcontainer4$(LIBEXT)        : $(OBJECTS_QAXCONTAINER)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqaxserver4$(LIBEXT)           : $(OBJECTS_QAXSERVER)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqtcore4$(LIBEXT)              : $(OBJECTS_QTCORE)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqtdeclarative4$(LIBEXT)       : $(OBJECTS_QTDECLARATIVE)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqtdesigner4$(LIBEXT)          : $(OBJECTS_QTDESIGNER)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqtgui4$(LIBEXT)               : $(OBJECTS_QTGUI)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqthelp4$(LIBEXT)              : $(OBJECTS_QTHELP)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqtmultimedia4$(LIBEXT)        : $(OBJECTS_QTMULTIMEDIA)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqtnetwork4$(LIBEXT)           : $(OBJECTS_QTNETWORK)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqtopengl4$(LIBEXT)            : $(OBJECTS_QTOPENGL)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqtscript4$(LIBEXT)            : $(OBJECTS_QTSCRIPT)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqtscripttools4$(LIBEXT)       : $(OBJECTS_QTSCRIPTTOOLS)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqtsql4$(LIBEXT)               : $(OBJECTS_QTSQL)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqtsvg4$(LIBEXT)               : $(OBJECTS_QTSVG)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqttest4$(LIBEXT)              : $(OBJECTS_QTTEST)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqtuitools4$(LIBEXT)           : $(OBJECTS_QTUITOOLS)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqtwebkit4$(LIBEXT)            : $(OBJECTS_QTWEBKIT)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqtxml4$(LIBEXT)               : $(OBJECTS_QTXML)
	link /lib /out:$@ $^
$(QT4XHB_LIB_DIR)/$(LIBPRE)hbqtxmlpatterns4$(LIBEXT)       : $(OBJECTS_QTXMLPATTERNS)
	link /lib /out:$@ $^

$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# ActiveQt
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/ActiveQt/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/ActiveQt/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtCore
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtCore/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtCore/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtDeclarative
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtDeclarative/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtDeclarative/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtDesigner
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtDesigner/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtDesigner/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtGui
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtGui/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtGui/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtHelp
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtHelp/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtHelp/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtMultimedia
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtMultimedia/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtMultimedia/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtNetwork
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtNetwork/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtNetwork/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtOpenGL
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtOpenGL/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtOpenGL/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtScript
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtScript/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtScript/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtScriptTools
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtScriptTools/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtScriptTools/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtSql
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtSql/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtSql/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtSvg
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QSvg/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtSvg/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtTest
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtTest/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtTest/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtUiTools
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtUiTools/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtUiTools/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtWebKit
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtWebKit/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtWebKit/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtXml
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtXml/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtXml/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
# QtXmlPatterns
$(QT4XHB_OBJ_DIR)/%.c         : $(QT4XHB_SRC_DIR)/QtXmlPatterns/%.prg
	$(HB) $(PRGFLAGS) -I$(HB_INC_DIR) -I$(QT4XHB_INC_DIR) -o$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_SRC_DIR)/QtXmlPatterns/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^

$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_OBJ_DIR)/%.c
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^
$(QT4XHB_OBJ_DIR)/%$(OBJEXT) : $(QT4XHB_OBJ_DIR)/%.cpp
	$(CC) $(CFLAGS) $(CINCLUDES) -Fo$@ $^

$(QT4XHB_OBJ_DIR)/habstractlistmodelMoc.cpp    : $(QT4XHB_SRC_DIR)/habstractlistmodel.h
	$(MOC) $^ -o $@
$(QT4XHB_OBJ_DIR)/habstracttablemodelMoc.cpp   : $(QT4XHB_SRC_DIR)/habstracttablemodel.h
	$(MOC) $^ -o $@
$(QT4XHB_OBJ_DIR)/habstracttablemodelV2Moc.cpp : $(QT4XHB_SRC_DIR)/habstracttablemodelV2.h
	$(MOC) $^ -o $@

include mak/modules9.mak
